<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me de Cache Multi-Niveaux - Alexa Advanced Control</title>
    <style>
        :root {
            --primary-color: #0066cc;
            --secondary-color: #ff6600;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --dark-bg: #1e1e1e;
            --light-bg: #f8f9fa;
            --border-color: #dee2e6;
            --code-bg: #f4f4f4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.6rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            color: #000000;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
            color: #000000;
        }

        nav {
            background-color: var(--dark-bg);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: var(--primary-color);
        }

        section {
            margin: 40px 0;
            padding: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        h2 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--primary-color);
        }

        h3 {
            color: var(--secondary-color);
            font-size: 1.5em;
            margin: 25px 0 15px;
        }

        h4 {
            color: #555;
            font-size: 1.2em;
            margin: 20px 0 10px;
        }

        .diagram-container {
            margin: 30px 0;
            padding: 20px;
            background-color: var(--light-bg);
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }

        .diagram-container iframe {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 4px;
            background-color: white;
        }

        .diagram-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .diagram-tab {
            padding: 12px 24px;
            background-color: #e9ecef;
            border: none;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .diagram-tab:hover {
            background-color: #dee2e6;
        }

        .diagram-tab.active {
            background-color: var(--primary-color);
            color: white;
        }

        .diagram-content {
            display: none;
        }

        .diagram-content.active {
            display: block;
        }

        .info-box {
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--primary-color);
            background-color: var(--light-bg);
            border-radius: 4px;
        }

        .info-box.warning {
            border-left-color: var(--warning-color);
            background-color: #fff3cd;
        }

        .info-box.success {
            border-left-color: var(--success-color);
            background-color: #d4edda;
        }

        .info-box.danger {
            border-left-color: var(--danger-color);
            background-color: #f8d7da;
        }

        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .performance-table th,
        .performance-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .performance-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .performance-table tr:hover {
            background-color: var(--light-bg);
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 0 4px;
        }

        .badge-fast {
            background-color: var(--success-color);
            color: white;
        }

        .badge-medium {
            background-color: var(--warning-color);
            color: #333;
        }

        .badge-slow {
            background-color: var(--danger-color);
            color: white;
        }

        code {
            background-color: var(--code-bg);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: var(--code-bg);
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid var(--primary-color);
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            padding: 20px;
            background-color: var(--light-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .feature-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .flow-diagram {
            padding: 30px;
            background: linear-gradient(to bottom, #f8f9fa, #ffffff);
            border-radius: 8px;
            margin: 20px 0;
        }

        .flow-step {
            margin: 20px 0;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .flow-step.level-1 { border-left-color: var(--success-color); }
        .flow-step.level-2 { border-left-color: var(--warning-color); }
        .flow-step.level-3 { border-left-color: var(--danger-color); }

        footer a {
            color: white;
            text-decoration: none;
            border-bottom: 1px dotted white;
        }

        footer a:hover {
            border-bottom-color: var(--primary-color);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            .diagram-tabs {
                flex-direction: column;
            }

            .diagram-tab {
                width: 100%;
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-card .label {
            font-size: 1em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <header>
        <h1>Syst√®me de Cache Multi-Niveaux</h1>
        <p>Alexa Advanced Control - Documentation Technique</p>
    </header>

    <nav>
        <ul>
            <li><a href="#overview">Vue d'ensemble</a></li>
            <li><a href="#diagrams">Diagrammes</a></li>
            <li><a href="#architecture">Architecture</a></li>
            <li><a href="#performance">Performance</a></li>
            <li><a href="#configuration">Configuration</a></li>
            <li><a href="#debug">D√©bogage</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="overview">
            <h2>üéØ Vue d'ensemble</h2>
            
            <p>Le syst√®me de cache d'Alexa Advanced Control utilise une architecture √† <strong>2 niveaux + fallback</strong> pour optimiser les performances et r√©duire les appels API vers Amazon.</p>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number">‚ö° 1-2ms</div>
                    <div class="label">Cache M√©moire</div>
                </div>
                <div class="stat-card">
                    <div class="number">üíæ 10-50ms</div>
                    <div class="label">Cache Disque</div>
                </div>
                <div class="stat-card">
                    <div class="number">üåê 200-1000ms</div>
                    <div class="label">API Amazon</div>
                </div>
                <div class="stat-card">
                    <div class="number">‚àû</div>
                    <div class="label">TTL Disque</div>
                </div>
            </div>

            <div class="flow-diagram">
                <h3>Flux de Cache</h3>
                
                <div class="flow-step level-1">
                    <h4>üìç Niveau 1 : Cache M√©moire (RAM)</h4>
                    <ul>
                        <li><strong>TTL :</strong> 5 minutes (300s)</li>
                        <li><strong>Stockage :</strong> Variable Python <code>_devices_cache</code></li>
                        <li><strong>Performance :</strong> <span class="badge badge-fast">‚ö° Instantan√© (~1ms)</span></li>
                        <li><strong>Persistance :</strong> ‚ùå Perdu au red√©marrage</li>
                    </ul>
                </div>

                <div style="text-align: center; font-size: 2em; margin: 10px 0;">‚Üì</div>

                <div class="flow-step level-2">
                    <h4>üìç Niveau 2 : Cache Disque Fallback (Fichier)</h4>
                    <ul>
                        <li><strong>TTL :</strong> ‚àû AUCUN - Toujours valide si pr√©sent</li>
                        <li><strong>Stockage :</strong> <code>data/cache/devices.json.gz</code></li>
                        <li><strong>Compression :</strong> gzip (~70% r√©duction)</li>
                        <li><strong>Performance :</strong> <span class="badge badge-medium">üíæ Rapide (~10-50ms)</span></li>
                        <li><strong>Persistance :</strong> ‚úÖ Survit au red√©marrage</li>
                        <li><strong>Usage :</strong> Fallback au d√©marrage uniquement</li>
                    </ul>
                </div>

                <div style="text-align: center; font-size: 2em; margin: 10px 0;">‚Üì</div>

                <div class="flow-step level-3">
                    <h4>üìç Niveau 3 : API Amazon (HTTP)</h4>
                    <ul>
                        <li><strong>URL :</strong> <code>alexa.amazon.com/api/devices-v2/device</code></li>
                        <li><strong>Performance :</strong> <span class="badge badge-slow">üåê Lent (~200-1000ms)</span></li>
                        <li><strong>Action :</strong> Met √† jour cache m√©moire ET disque</li>
                    </ul>
                </div>
            </div>

            <div class="info-box warning">
                <h4>‚ö†Ô∏è IMPORTANT</h4>
                <p>Le cache disque n'a <strong>pas de TTL</strong>. Il est utilis√© uniquement comme <strong>fallback persistant</strong> :</p>
                <ul>
                    <li>Au premier d√©marrage de l'application</li>
                    <li>Apr√®s expiration du cache m√©moire (5 min) ET absence de connexion API</li>
                    <li>Jamais pendant l'utilisation normale (cache m√©moire suffit)</li>
                </ul>
            </div>
        </section>

        <section id="diagrams">
            <h2>üìä Diagrammes Interactifs</h2>

            <div class="info-box success">
                <p><strong>üí° Astuce :</strong> Cliquez sur les onglets ci-dessous pour naviguer entre les diff√©rents diagrammes PlantUML.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-tabs">
                    <button class="diagram-tab active" onclick="showDiagram('flow')">üîÑ Flux de Cache</button>
                    <button class="diagram-tab" onclick="showDiagram('architecture')">üèóÔ∏è Architecture</button>
                    <button class="diagram-tab" onclick="showDiagram('states')">üîÄ Machine √† √âtats</button>
                    <button class="diagram-tab" onclick="showDiagram('performance')">‚ö° Performances</button>
                </div>

                <div id="diagram-flow" class="diagram-content active">
                    <h3>Flux de Cache Multi-Niveaux</h3>
                    <p>Ce diagramme illustre les <strong>trois sc√©narios possibles</strong> lors de la r√©cup√©ration de la liste des appareils :</p>
                    <iframe src="http://www.plantuml.com/plantuml/svg/lLNBRjD05DtFLrpIJLgHDWbKGXQf6j87eBxKf9MG8bLJ-yQPrfv9PyPfwHx4eWlK9UAv8tm46_z9lu1Fu8xjGD9MGY2LdJDtxZtdddFiB1lBjKtY27pkz_6W5wdJWq3mKFEOtRDzZ1464HUIcMCX1voEuP3xnw5MYGnQAb8QJll2uaGzm1vF8hkcf6sBSuHQVQAeqRTSXX7-BZ-SA4jb9oerngom4KBxfR7fL-8I8BGSKTWa157P4aFaoHbKO0M7maVO4COondrBl4fxLaJ2S8k9BW4ta1ZKZ72iyCM0ImkbriQphkGHdd6Qd0sW1fjTzYC1CniYxDidKOBJRJdO9fSyHDsL8Tg3lDsKPxFc82vwrpMYl8QPyqz7iH8QkxAyszoSxSfEPyE3HOY5p2R4I2DUO4H-tDBUHktWCkYo2ANIU61jrEZe17C6le6PRKrAusteAyAS90wxe3r_P9IS3y_7FAxUV8JcNcjlAzz6cEDYdvRIF9gUs8pvkPBGt1bBES-patbVnLax7v2IknWmrcX0sqz7ackXeER1j1ImpoD11ZSQp3a5bILdWWSt_67E6we6iGTJsZFIdSv9Em_sqv4MFK5pQ2Fcv1nNhjw_ScVmE9URkSo1TjjvC3TtzUuBr2frYCtSNDvM8BbePG5yH1kH0YWYam6EUUwYLOdEoT6Psy63Pgyd_3xbvDhszHlRhvuDX4v7SFNwil3dxfNuS94fiLGeaJVv9XjMBXNJIlVXUiGOnSl1KZ2SCCJURKaGBClAhvAJUYsl09uv0IbpfD8H2MLWcFazUys07vyklqEjMbciPXvqvOwB8C8mNyFdLb3St2evLi5uHKcPZf2kfYDAta2ZCUvtHlLF5XPwR0g3a7u6Ho__80AzdFzkyWCF2lAvryvQUa_-Yw_xxbKgamonkq6Yn5nheZXx1ouJtDXbVcXGsadHjvJ40fE-11wihtPWWPuM2k3Ai5uytWZ2nLkeLwkLMhKwpi9kEZf9qczqxMcdiyFSfsMCGwM1acJWy_RsLW6OyslpP8WXrm7nAuVdOZ0burJLVOl_okzbb07zVRAV"></iframe>
                    <p style="margin-top: 15px;"><em>Source : <code>diagrams/cache_flow_diagram.puml</code></em></p>
                </div>

                <div id="diagram-architecture" class="diagram-content">
                    <h3>Architecture Globale</h3>
                    <p>Vue d'ensemble montrant les interactions entre tous les composants du syst√®me de cache.</p>
                    <iframe src="http://www.plantuml.com/plantuml/svg/TLJRRjD047ttLmn5I4c5aLk4X2A120cNehHKJOG4BKBJzSHPkfUmbq11yCnN81u9l-4_uKkOjPEI5l135C_rp9dZUU03kX2r0e5YHc_GYPaC949qb5qBCz84SuNIPFvCcZawr72AugnoDffoO9Lry3vbRFY5rNDho8HnE5S4ZgkXgHHbMP213VsD7b1669_xKF_WHYN18A78iZctm8fWQw0a5u8HdfFRWayPy7Cy6Et1m6gDflIl0Jq89RFF6raFevU6l8UHhQIuo1lIGWhQHyD1xiIq4uUWxjqkYhPGgI_LQT1SRdxXEv0BmWWxaCCBgp18HUkOz9GOy1Gz1-wPV9-qTUVjS2TcA4Kuzi7TX97quVM9cKn6FRW3Mfgj14AJXkilIIdxlYdtkVdzP_TTxdv8pdCTfccp_t7JR4mkZNnYP6MiQuUTk4WjQ_uVQ8VIdws1FXi_FxZrv1LCUJQ_WldhwpVep1DL16peDeZBb7Hz9AjP65Y7QWLxayf77m8vWmhwXtjhd4BPMC9MN-D7Qw2lw0EsRYw9ysQbl5d8y_ky6EX1HU5DsUpGTxePcv8diTM35_NIoQaar-eOTBtKLhA6Lr72j_cTAqHqC_Oq3T88FTu8Qt8gMQ3hKkiA38ZzH_GkrZy3mTF9v12y18mYcbLa2ha0UrGl-IjWIXEBby7kIpRNt-6jZGwE-ljhxmh36EE2AdJCC5lUHOBEGYAFqCqoOxctIqI3dQPoJEJsTgjJCKEcipEpeSNJtTvcRyxwPN48wi5ElWlQDxPXTFMILggBWLhhPEO8ozpZb5sXUP6ckZMouYmZKqBgVXL30hq1Wa5x4ZoOXyuKbKh7ucyWHNwdk0gbKLQmyMsJl40bIrvFYdXidSRGQvXihelZRxjUGgVwAETjo0IbKbpaoztY1d2zCeeWhValwYIl17h8eaohTYtcgq1tYoBVAOeBh0VraiNd-Nhnulawci2Y4zYqIluZJWGbjGpC6ymjXvxouVk3uW7_vMkR_GO0"></iframe>
                    <p style="margin-top: 15px;"><em>Source : <code>diagrams/cache_architecture.puml</code></em></p>
                </div>

                <div id="diagram-states" class="diagram-content">
                    <h3>Machine √† √âtats du Cache</h3>
                    <p>Le cache √©volue entre diff√©rents √©tats selon l'utilisation et l'expiration des TTL.</p>
                    <iframe src="http://www.plantuml.com/plantuml/svg/dLJDRjD04BxxAOOJIL14KgcN2bKDfOTAb4OWSI4eMkoflMH_tDrrQ8KuLWAf1yGH5G4tmaDmyPlq2NW4PlqJErPwmQVTsM--R-QRzHvOnupBf82GXGdEQUjmBcdD5GRtN88I8HMCgy0kk4gPOHBUi70H6vsfw50BRU1TmXq6WUDE89oKkP3_WFmJiLc8CZZqv47mQl0QXiDzE9AfkuGzc1gK70r4-KeoOrXCcAA22l4-0FfgT442ah2Q6zo3suzNMyuZRi-pwlH3JNU2KflBKoLgpbPW2_7D5VGUmIv8hlftmTSwDosT9zmkMYhhxHQDRzVGmukKctpLtmvkAK3FwUojpeo59HCymdwZ-LYxvAKFLgBDVcjdTs0wxPIU-bcrePFfCS65cAaNB5jYp4pKiCE3YYHeKZn1gw-9SwWYWkwNvixKaNU0EQxLcYTO9tJbdsBeCbFNEbFFCKoOYPiIEihjt1ZTFC8b3z7s-ZErQKnbwapTVlq9u-4EIBjPHQk73b6tfh_Vl_o1yMYuE_8aZOtr9UsaJz8KXVVLPrv_XftHQ3WUZOhaG6aQh-5nua2VDTtG10U3ujy2dJekcHWCA3P5SwQDP2ganjY5ZwCFC_e3xny_FAsdKuM86S-p_BUNo5SMMHRGRC1hTfNhxbl2b6unz1Uoq9wa9lzbow6I6bSiT7p9NRwYmqsBmB2KlFwFCWeBMpLmnHslcwzU4k7RbwWSnPxbAtBPqjjKNDoGBYv5ZyiiRX44slBPiotD0rhIUnZy0m00"></iframe>
                    <p style="margin-top: 15px;"><em>Source : <code>diagrams/cache_state_machine.puml</code></em></p>
                </div>

                <div id="diagram-performance" class="diagram-content">
                    <h3>Comparaison de Performances</h3>
                    <p>Analyse d√©taill√©e des performances pour chaque niveau de cache avec latence et probabilit√©.</p>
                    <iframe src="http://www.plantuml.com/plantuml/svg/ZPJDQjj04CVl-nHJIi0HE542WTGkDC8n8KLrXEqS2eMoaSRsDlkXxguS9-GHUYWzzb9wYr-Y5xz9dw2Fq97ar7P2Q2xws9dzp_n_izAHyzpwGab8UJh1ZpdQaR6AwnJP2pz1XP1BBZHpbqBdt7855poz75jJwAnZfB5mDH4U6VF2IuIEKMMMS4P3XWwIbPw39dJA8Z1r42MdZDsUUo65unuBUykgJbYhErlCqyAZ_Q23W4kSSHAQYXI1KdqGj6dVuDhvnPt2MoP6qAX5rMAkZB2apgN8yCqsKFiQ6cU5s6O0BsCndlWJYwXRSPbM-OL-zAvDKMqyWYqpw0KW27v__mddyR0VKKPoUjmDWYeGKwzafGLxpNrGhbfBhBdW5sJ4B-OjE0otgjM64_0Q3a09NPP7dLL5w77JzMPdqMWag2qBXy1p0eb2kh8_vqtEK3g4HizKWYlZcN2V2mIS4Pv7jad-FKffhchJfReeqTP8tSud6jJE-AQzaNfC4w0vMdGExMQeC-5sJFrHYNlWTS83WYN3Fp--_Th4jmumR1w4zmWVGjnxjRLSR_3SBkuSkSk5vLxKvclz91h0SHU6mtWflmRvCUQLXwSWBp6JpZfesjV7h1NbEShos4Aa-8tHxLNef3k4NPwBtINKvdH_-RYMb71BCE7juAotjZhWnHJ7t6OKgkVuHF0PiBzyXRZR6pv6lH-6pRqmV9hsFzWqSaN70sJvlIhKVljPN2i-_uMgCp5YzPKTqPr-Ekml"></iframe>
                    <p style="margin-top: 15px;"><em>Source : <code>diagrams/cache_performance.puml</code></em></p>
                </div>
            </div>

        </section>

        <section id="architecture">
            <h2>üèóÔ∏è Architecture Technique</h2>

            <h3>Pattern Commun : Architecture √† 2 Niveaux</h3>
            <p>Tous les managers et services suivent la m√™me architecture de cache pour garantir coh√©rence et performance :</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üì¶ Managers Core</h4>
                    <p><code>core/*/</code></p>
                    <ul>
                        <li><strong>DeviceManager</strong> - Appareils Alexa</li>
                        <li><strong>TimerManager</strong> - Timers actifs</li>
                        <li><strong>AlarmManager</strong> - Alarmes programm√©es</li>
                        <li><strong>ReminderManager</strong> - Rappels</li>
                        <li><strong>RoutineManager</strong> - Routines Alexa</li>
                        <li><strong>NotificationManager</strong> - Notifications</li>
                        <li><strong>DNDManager</strong> - Mode Ne pas d√©ranger</li>
                        <li><strong>ActivityManager</strong> - Historique d'activit√©s</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üè† Smart Home Controllers</h4>
                    <p><code>core/smart_home/</code></p>
                    <ul>
                        <li><strong>LightController</strong> - Lumi√®res connect√©es</li>
                        <li><strong>ThermostatController</strong> - Thermostats</li>
                        <li><strong>PlugController</strong> - Prises intelligentes</li>
                        <li><strong>SwitchController</strong> - Interrupteurs</li>
                        <li><strong>SensorController</strong> - Capteurs</li>
                        <li><strong>LockController</strong> - Serrures connect√©es</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>ÔøΩ Music & Media</h4>
                    <p><code>core/music/</code> & <code>core/audio/</code></p>
                    <ul>
                        <li><strong>MusicLibraryService</strong> - Biblioth√®que musicale</li>
                        <li><strong>PlaybackController</strong> - Contr√¥le lecture</li>
                        <li><strong>PlaylistManager</strong> - Playlists</li>
                        <li><strong>TuneinService</strong> - Stations radio</li>
                        <li><strong>AudioController</strong> - Volume et param√®tres</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>ÔøΩ Services Utilitaires</h4>
                    <p><code>services/</code></p>
                    <ul>
                        <li><strong>CacheService</strong> - Gestion cache disque</li>
                        <li><strong>SyncService</strong> - Synchronisation</li>
                        <li><strong>VoiceCommandService</strong> - Commandes vocales</li>
                        <li><strong>AuthService</strong> - Authentification</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üìã List Management</h4>
                    <p><code>core/lists/</code></p>
                    <ul>
                        <li><strong>TodoListManager</strong> - Listes de t√¢ches</li>
                        <li><strong>ShoppingListManager</strong> - Listes de courses</li>
                        <li><strong>ListItemController</strong> - Items de liste</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üîê M√©canismes de S√©curit√©</h4>
                    <p>Thread-Safety et Performance</p>
                    <ul>
                        <li><strong>threading.RLock</strong> - Cache m√©moire</li>
                        <li><strong>File locking</strong> - Cache disque</li>
                        <li><strong>Op√©rations atomiques</strong> - Lecture/√©criture</li>
                        <li><strong>Exception handling</strong> - Fallback gracieux</li>
                    </ul>
                </div>
            </div>

            <h3>Principes du Pattern Standard</h3>
            <div class="info-box">
                <h4>üí° Architecture Commune √† Tous les Composants</h4>
                <p>Chaque manager et service suit le m√™me pattern architectural pour garantir coh√©rence et performance :</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>1Ô∏è‚É£ Injection de D√©pendances</h4>
                        <ul>
                            <li><strong>CacheService optionnel</strong> en param√®tre</li>
                            <li><strong>Cr√©ation automatique</strong> si non fourni</li>
                            <li><strong>Partage possible</strong> entre composants</li>
                            <li><strong>Testabilit√©</strong> facilit√©e (mock)</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>2Ô∏è‚É£ Cache M√©moire (Niveau 1)</h4>
                        <ul>
                            <li><strong>Variables d'instance</strong> (_cache, _cache_timestamp)</li>
                            <li><strong>TTL configurable</strong> (d√©faut: 300s)</li>
                            <li><strong>Thread-safe</strong> avec threading.RLock</li>
                            <li><strong>Performance</strong> : ‚ö° 1-2 ms</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>3Ô∏è‚É£ Cache Disque (Niveau 2)</h4>
                        <ul>
                            <li><strong>Via CacheService</strong> centralis√©</li>
                            <li><strong>Compression gzip</strong> automatique</li>
                            <li><strong>TTL param√©trable</strong> ou ‚àû (fallback)</li>
                            <li><strong>Performance</strong> : üíæ 10-50 ms</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>4Ô∏è‚É£ Fallback API (Niveau 3)</h4>
                        <ul>
                            <li><strong>Appel Amazon</strong> si pas de cache</li>
                            <li><strong>Mise √† jour</strong> des 2 niveaux de cache</li>
                            <li><strong>Gestion d'erreurs</strong> gracieuse</li>
                            <li><strong>Performance</strong> : üåê 200-1000 ms</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>5Ô∏è‚É£ Thread Safety</h4>
                        <ul>
                            <li><strong>RLock</strong> pour cache m√©moire</li>
                            <li><strong>File locking</strong> pour cache disque</li>
                            <li><strong>Op√©rations atomiques</strong> garanties</li>
                            <li><strong>S√©curit√©</strong> multi-thread</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>6Ô∏è‚É£ Flexibilit√©</h4>
                        <ul>
                            <li><strong>force_refresh</strong> pour bypass du cache</li>
                            <li><strong>TTL personnalisable</strong> par composant</li>
                            <li><strong>ignore_ttl</strong> pour fallback persistant</li>
                            <li><strong>Extensible</strong> pour nouveaux besoins</li>
                        </ul>
                    </div>
                </div>

                <p><strong>‚úÖ Avantages de cette architecture :</strong></p>
                <ul>
                    <li>‚ú® <strong>Coh√©rence</strong> : Tous les composants fonctionnent de la m√™me mani√®re</li>
                    <li>üöÄ <strong>Performance</strong> : Cache m√©moire ultra-rapide (1-2ms)</li>
                    <li>üí™ <strong>R√©silience</strong> : Cache disque persistant en fallback</li>
                    <li>üîí <strong>S√©curit√©</strong> : Thread-safe pour utilisation concurrente</li>
                    <li>üß™ <strong>Testabilit√©</strong> : Injection de d√©pendances facilit√©e</li>
                    <li>üìà <strong>Scalabilit√©</strong> : Pattern extensible √† de nouveaux composants</li>
                </ul>
            </div>
        </section>

        <section id="performance">
            <h2>‚ö° Performance et Statistiques</h2>

            <h3>Tableau Comparatif</h3>
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>Niveau</th>
                        <th>Source</th>
                        <th>Latence</th>
                        <th>TTL</th>
                        <th>Persistance</th>
                        <th>Probabilit√©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="badge badge-fast">Niveau 1</span></td>
                        <td>Cache M√©moire (RAM)</td>
                        <td><strong>1-2 ms</strong></td>
                        <td>5 minutes</td>
                        <td>‚ùå Non</td>
                        <td>~80%</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-medium">Niveau 2</span></td>
                        <td>Cache Disque (JSON.GZ)</td>
                        <td><strong>10-50 ms</strong></td>
                        <td>‚àû Aucun</td>
                        <td>‚úÖ Oui</td>
                        <td>~19%</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-slow">Niveau 3</span></td>
                        <td>API Amazon</td>
                        <td><strong>200-1000 ms</strong></td>
                        <td>-</td>
                        <td>-</td>
                        <td>~1%</td>
                    </tr>
                </tbody>
            </table>

            <h3>Gains de Performance</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìà R√©duction de Latence</h4>
                    <p><strong>100x √† 1000x plus rapide</strong></p>
                    <p>Par rapport √† un appel API direct (cache m√©moire vs API)</p>
                </div>

                <div class="feature-card">
                    <h4>üí∞ √âconomie d'API Calls</h4>
                    <p><strong>~99% de r√©duction</strong></p>
                    <p>Gr√¢ce au cache m√©moire et disque combin√©s</p>
                </div>

                <div class="feature-card">
                    <h4>üóúÔ∏è Compression</h4>
                    <p><strong>~70% de r√©duction</strong></p>
                    <p>Compression gzip pour le cache disque</p>
                </div>
            </div>

            <h3>Sc√©narios d'Utilisation R√©els</h3>
            <div class="info-box">
                <h4>Exemple : 100 commandes "alexa device list"</h4>
                <ul>
                    <li><strong>80 commandes</strong> ‚Üí Cache m√©moire (< 5 min entre les appels) = <strong>160 ms total</strong></li>
                    <li><strong>19 commandes</strong> ‚Üí Cache disque (apr√®s expiration) = <strong>950 ms total</strong></li>
                    <li><strong>1 commande</strong> ‚Üí API (premier d√©marrage) = <strong>500 ms total</strong></li>
                    <li><strong>TOTAL :</strong> ~1.6 secondes vs ~50 secondes sans cache = <strong>97% plus rapide</strong></li>
                </ul>
            </div>
        </section>

        <section id="configuration">
            <h2>‚öôÔ∏è Configuration</h2>

            <h3>Variables d'Environnement</h3>
            <pre><code class="language-bash"># Cache m√©moire TTL (secondes)
ALEXA_CACHE_TTL=300  # D√©faut: 5 minutes

# Dossier de cache disque
ALEXA_CACHE_DIR=data/cache

# Activer/d√©sactiver la compression
ALEXA_CACHE_COMPRESSION=true
</code></pre>

            <h3>Configuration Programmatique</h3>
            <pre><code class="language-python">from core.device_manager import DeviceManager
from services.cache_service import CacheService

# Personnaliser le TTL du cache m√©moire
device_manager = DeviceManager(cache_ttl=600)  # 10 minutes

# Configurer le service de cache
cache_service = CacheService(
    cache_dir="custom/cache/path",
    compression=True
)
</code></pre>

            <h3>Structure des Fichiers de Cache</h3>
            <table class="performance-table">
                <thead>
                    <tr>
                        <th>Fichier Cache</th>
                        <th>Composant</th>
                        <th>TTL Disque</th>
                        <th>TTL M√©moire</th>
                        <th>Contenu</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>devices.json.gz</code></td>
                        <td>DeviceManager</td>
                        <td>‚àû (fallback)</td>
                        <td>5 min</td>
                        <td>Liste de tous les appareils Alexa</td>
                    </tr>
                    <tr>
                        <td><code>timers.json.gz</code></td>
                        <td>TimerManager</td>
                        <td>5 min</td>
                        <td>5 min</td>
                        <td>Timers actifs et en cours</td>
                    </tr>
                    <tr>
                        <td><code>smart_home_all.json.gz</code></td>
                        <td>Smart Home Controllers</td>
                        <td>Selon config</td>
                        <td>Selon config</td>
                        <td>√âtats des appareils connect√©s</td>
                    </tr>
                    <tr>
                        <td><code>sync_stats.json.gz</code></td>
                        <td>SyncService</td>
                        <td>24 heures</td>
                        <td>24 heures</td>
                        <td>Statistiques de synchronisation</td>
                    </tr>
                    <tr>
                        <td><code>*.json.gz.meta</code></td>
                        <td>CacheService</td>
                        <td>-</td>
                        <td>-</td>
                        <td>M√©tadonn√©es (timestamp, TTL, etc.)</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <h4>üìÅ Emplacement du Cache</h4>
                <p><strong>Par d√©faut :</strong> <code>data/cache/</code> (relatif √† la racine du projet)</p>
                <p><strong>Taille typique :</strong></p>
                <ul>
                    <li><code>devices.json.gz</code> : ~5-15 KB (8 appareils compress√©s)</li>
                    <li><code>timers.json.gz</code> : ~1-3 KB</li>
                    <li><code>smart_home_all.json.gz</code> : ~10-50 KB (d√©pend du nombre d'appareils)</li>
                    <li><strong>Total :</strong> G√©n√©ralement < 100 KB</li>
                </ul>
            </div>

            <h3>Param√®tres Avanc√©s</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üéõÔ∏è TTL Personnalis√©s</h4>
                    <p>Chaque composant peut d√©finir son propre TTL :</p>
                    <ul>
                        <li><strong>DeviceManager :</strong> cache_ttl (d√©faut: 300s)</li>
                        <li><strong>TimerManager :</strong> cache_ttl (d√©faut: 300s)</li>
                        <li><strong>SyncService :</strong> 86400s (24h)</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üîí Param√®tre ignore_ttl</h4>
                    <p>Mode fallback sans expiration :</p>
                    <ul>
                        <li><strong>Usage :</strong> DeviceManager uniquement</li>
                        <li><strong>Effet :</strong> Lit le cache disque m√™me expir√©</li>
                        <li><strong>Cas :</strong> D√©marrage, erreur API, mode offline</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üóúÔ∏è Compression GZIP</h4>
                    <p>Toujours activ√©e par d√©faut :</p>
                    <ul>
                        <li><strong>Niveau :</strong> 6 (balance vitesse/taux)</li>
                        <li><strong>Gain :</strong> ~70% de r√©duction</li>
                        <li><strong>Performance :</strong> N√©gligeable sur le temps total</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="debug">
            <h2>üîç D√©bogage et Maintenance</h2>

            <h3>Logs de Cache</h3>
            <div class="info-box">
                <p>Le syst√®me g√©n√®re des logs d√©taill√©s pour chaque op√©ration de cache :</p>
            </div>

            <pre><code class="language-log">‚úÖ Cache HIT (m√©moire) - devices: 8 appareils (√¢ge: 2min)
‚úÖ Cache HIT (disque, ignoring TTL) - devices: 8 appareils
‚ö†Ô∏è Cache MISS - devices: Appel API n√©cessaire
üíæ Cache SET (m√©moire + disque) - devices: 8 appareils sauvegard√©s
</code></pre>

            <h3>Commandes de Maintenance</h3>
            <pre><code class="language-bash"># Voir les statistiques de cache
python alexa cache stats

# Vider le cache m√©moire
python alexa cache clear --memory

# Vider le cache disque
python alexa cache clear --disk

# Vider tout le cache
python alexa cache clear --all

# Afficher le contenu du cache
python alexa cache show
</code></pre>

            <h3>Statistiques Disponibles</h3>
            <pre><code class="language-python">from core.device_manager import DeviceManager

dm = DeviceManager()
stats = dm.get_cache_stats()

print(f"Hits: {stats['hits']}")
print(f"Misses: {stats['misses']}")
print(f"Hit Rate: {stats['hit_rate']:.2%}")
print(f"Avg Latency: {stats['avg_latency_ms']:.2f} ms")
</code></pre>

            <div class="info-box warning">
                <h4>‚ö†Ô∏è Probl√®mes Courants</h4>
                <ul>
                    <li><strong>Cache toujours vide :</strong> V√©rifier les permissions du dossier <code>data/cache/</code></li>
                    <li><strong>Latence √©lev√©e :</strong> Le cache disque peut √™tre corrompu, utiliser <code>cache clear --disk</code></li>
                    <li><strong>Donn√©es obsol√®tes :</strong> Forcer un refresh avec <code>--no-cache</code></li>
                </ul>
            </div>
        </section>

        <section>
            <h2>ÔøΩ B√©n√©fices M√©tier</h2>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üöÄ Exp√©rience Utilisateur</h4>
                    <ul>
                        <li><strong>R√©activit√© :</strong> R√©ponses instantan√©es (1-2ms)</li>
                        <li><strong>Disponibilit√© :</strong> Fonctionne m√™me hors ligne (fallback)</li>
                        <li><strong>Fluidit√© :</strong> Pas de d√©lais d'attente r√©seau</li>
                        <li><strong>Fiabilit√© :</strong> Moins d'erreurs API</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üí∞ √âconomies Techniques</h4>
                    <ul>
                        <li><strong>Bande passante :</strong> -99% de requ√™tes r√©seau</li>
                        <li><strong>Rate Limiting :</strong> √âvite les limitations Amazon</li>
                        <li><strong>Co√ªts serveur :</strong> Moins de charge API</li>
                        <li><strong>Batterie :</strong> Moins de radios actives (mobile)</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üîß Maintenance Simplifi√©e</h4>
                    <ul>
                        <li><strong>Logs clairs :</strong> Hit/Miss explicites</li>
                        <li><strong>Statistiques :</strong> Taux de r√©ussite mesurable</li>
                        <li><strong>D√©bogage facile :</strong> Fichiers cache lisibles</li>
                        <li><strong>Monitoring :</strong> M√©triques de performance</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üåç Mode Offline</h4>
                    <ul>
                        <li><strong>D√©gradation gracieuse :</strong> Donn√©es du dernier refresh</li>
                        <li><strong>Persistance :</strong> Cache disque illimit√©</li>
                        <li><strong>R√©silience :</strong> Fonctionne sans connexion</li>
                        <li><strong>Continuit√© :</strong> Pas d'interruption utilisateur</li>
                    </ul>
                </div>
            </div>
        </section>

        <section>
            <h2>üìö Ressources Suppl√©mentaires</h2>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìÑ Documentation</h4>
                    <ul>
                        <li><a href="diagrams/README.md">Guide des Diagrammes</a></li>
                        <li><a href="CACHE_SYSTEM.md">Documentation Markdown</a></li>
                        <li><a href="../README.md">README Principal</a></li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üé® Diagrammes PlantUML</h4>
                    <ul>
                        <li><a href="diagrams/cache_flow_diagram.puml">Flux de Cache</a></li>
                        <li><a href="diagrams/cache_architecture.puml">Architecture</a></li>
                        <li><a href="diagrams/cache_state_machine.puml">Machine √† √âtats</a></li>
                        <li><a href="diagrams/cache_performance.puml">Performances</a></li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h4>üõ†Ô∏è Scripts</h4>
                    <ul>
                        <li><a href="../scripts/generate_cache_plantuml.py">G√©n√©rateur de Diagrammes</a></li>
                        <li><code>python alexa cache stats</code></li>
                        <li><code>python alexa cache clear</code></li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>&copy; 2025 Alexa Advanced Control - Syst√®me de Cache Multi-Niveaux</p>
        <p>Documentation g√©n√©r√©e automatiquement | <a href="https://github.com/weedmanu/alexa_advanced_control">GitHub Repository</a></p>
    </footer>

    <script>
        function showDiagram(diagramId) {
            // Masquer tous les diagrammes
            const allDiagrams = document.querySelectorAll('.diagram-content');
            allDiagrams.forEach(diagram => {
                diagram.classList.remove('active');
            });

            // D√©sactiver tous les onglets
            const allTabs = document.querySelectorAll('.diagram-tab');
            allTabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Afficher le diagramme s√©lectionn√©
            const selectedDiagram = document.getElementById(`diagram-${diagramId}`);
            if (selectedDiagram) {
                selectedDiagram.classList.add('active');
            }

            // Activer l'onglet s√©lectionn√©
            event.target.classList.add('active');
        }

        // Smooth scroll pour la navigation
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight du code (basique)
        document.addEventListener('DOMContentLoaded', function() {
            const codeBlocks = document.querySelectorAll('pre code');
            codeBlocks.forEach(block => {
                // Ajout de num√©ros de ligne
                const lines = block.textContent.split('\n');
                block.innerHTML = lines.map((line, i) => 
                    `<span class="line-number">${i + 1}</span>${line}`
                ).join('\n');
            });
        });
    </script>
</body>
</html>
